function [f,g,h]=demo_9_30_4(x)
f = (x(1)^2+2*x(1))*exp(-x(1)^2-x(2)^2-x(1)*x(2));

if nargout > 1 % gradient required
    g = [exp(- 2*x(1)^2 - x(2)*x(1))*(2*x(1) + 2) - exp(- 2*x(1)^2 - x(2)*x(1))*(x(1)^2 + 2*x(1))*(4*x(1) + x(2))
        -x(1)*exp(- 2*x(1)^2 - x(2)*x(1))*(x(1)^2 + 2*x(1))];
    if nargout > 2
     h= [ 2*exp(- x(1)*x(2) - 2*x(1)^2) - 4*exp(- x(1)*x(2) - 2*x(1)^2)*(2*x(1) + x(1)^2) - 2*exp(- x(1)*x(2) - 2*x(1)^2)*(2*x(1) + 2)*(4*x(1) + x(2)) + exp(- x(1)*x(2) - 2*x(1)^2)*(2*x(1) + x(1)^2)*(4*x(1) + x(2))^2, exp(- x(1)*x(2) - 2*x(1)^2)*x(1)*(2*x(1) + x(1)^2)*(4*x(1) + x(2)) - exp(- x(1)*x(2) - 2*x(1)^2)*x(1)*(2*x(1) + 2) - exp(- x(1)*x(2) - 2*x(1)^2)*(2*x(1) + x(1)^2);
                                            exp(- x(1)*x(2) - 2*x(1)^2)*x(1)*(2*x(1) + x(1)^2)*(4*x(1) + x(2)) - exp(- x(1)*x(2) - 2*x(1)^2)*x(1)*(2*x(1) + 2) - exp(- x(1)*x(2) - 2*x(1)^2)*(2*x(1) + x(1)^2),                                                                                                               exp(- x(1)*x(2) - 2*x(1)^2)*x(1)^2*(2*x(1) + x(1)^2)];
        
    end
end